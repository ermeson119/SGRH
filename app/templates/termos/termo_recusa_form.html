{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
    <h2>Termo de Recusa de Vacinação</h2>
    <form method="post" id="form-termo">
        <div class="mb-3">
            <label for="nome" class="form-label">Nome</label>
            <select name="pessoa_id" id="nome" class="form-select" required>
                <option value="">Selecione</option>
                {% for pessoa in pessoas %}
                <option value="{{ pessoa.id }}"
                    data-nome="{{ pessoa.nome }}"
                    data-matricula="{{ pessoa.matricula }}"
                    data-lotacao="{{ pessoa.lotacoes[0].setor.nome if pessoa.lotacoes else '' }}"
                    data-funcao="{{ pessoa.profissao.nome if pessoa.profissao else '' }}"
                    data-cpf="{{ pessoa.cpf }}">
                    {{ pessoa.nome }}
                </option>
                {% endfor %}
            </select>
        </div>
        <div class="mb-3">
            <label for="instituicao" class="form-label">Instituição/Órgão Responsável</label>
            <input type="text" name="instituicao" id="instituicao" class="form-control" placeholder="Digite a instituição" required>
        </div>
        <div class="mb-3">
            <label for="cidade" class="form-label">Cidade</label>
            <input type="text" name="cidade" id="cidade" class="form-control" placeholder="Digite a cidade" required>
        </div>
        <div class="mb-3">
            <label for="vacina" class="form-label">Vacina</label>
            <select name="vacina" id="vacina" class="form-select" required>
                <option value="">Selecione</option>
                <option value="COVID-19">COVID-19</option>
                <option value="Influenza (Gripe)">Influenza (Gripe)</option>
                <option value="Hepatite B">Hepatite B</option>
                <option value="Tétano">Tétano</option>
                <option value="Febre Amarela">Febre Amarela</option>
                <option value="Tríplice Viral (Sarampo, Caxumba e Rubéola)">Tríplice Viral (Sarampo, Caxumba e Rubéola)</option>
                <option value="Pneumocócica">Pneumocócica</option>
                <option value="Meningocócica">Meningocócica</option>
                <option value="HPV">HPV</option>
                <option value="Outra">Outra</option>
            </select>
        </div>
        <div class="mb-3">
            <label for="data" class="form-label">Data</label>
            <input type="date" name="data" id="data" class="form-control" required>
        </div>
        <button type="submit" class="btn btn-danger">Gerar PDF</button>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(function() {
    $('#nome').on('change', function() {
        var selected = $(this).find('option:selected');
        $('#matricula').val(selected.data('matricula') || '');
        $('#lotacao').val(selected.data('lotacao') || '');
        $('#funcao').val(selected.data('funcao') || '');
        $('#cpf').val(selected.data('cpf') || '');
    });
});
</script>
{% endblock %}
{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
    <h2>Termo de Recusa de Vacinação</h2>
    <form method="post" id="form-termo">
        <div class="mb-3">
            <label>Nome</label>
            <select name="pessoa_id" id="nome" class="form-select" required>
                <option value="">Selecione</option>
                {% for pessoa in pessoas %}
                <option value="{{ pessoa.id }}"
                    data-nome="{{ pessoa.nome }}"
                    data-matricula="{{ pessoa.matricula }}"
                    data-lotacao="{{ pessoa.lotacoes[0].setor.nome if pessoa.lotacoes else '' }}"
                    data-funcao="{{ pessoa.profissao.nome if pessoa.profissao else '' }}"
                    data-cpf="{{ pessoa.cpf }}">
                    {{ pessoa.nome }}
                </option>
                {% endfor %}
            </select>
        </div>
        <div class="mb-3">
            <label>Matrícula</label>
            <input type="text" name="matricula" id="matricula" class="form-control" required>
        </div>
        <div class="mb-3">
            <label>Lotação</label>
            <input type="text" name="lotacao" id="lotacao" class="form-control" required>
        </div>
        <div class="mb-3">
            <label>Função</label>
            <input type="text" name="funcao" id="funcao" class="form-control" required>
        </div>
        <div class="mb-3">
            <label>CPF</label>
            <input type="text" name="cpf" id="cpf" class="form-control" required>
        </div>
        <div class="mb-3">
            <label>Cidade</label>
            <input type="text" name="cidade" id="cidade" class="form-control" required>
        </div>
        <div class="mb-3">
            <label>Vacina</label>
            <input type="text" name="vacina" id="vacina" class="form-control" required>
        </div>
        <div class="mb-3">
            <label>Data</label>
            <input type="date" name="data" class="form-control" required>
        </div>
        <button type="submit" class="btn btn-success">Gerar PDF</button>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(function() {
    $('#nome').on('change', function() {
        var selected = $(this).find('option:selected');
        $('#matricula').val(selected.data('matricula') || '');
        $('#lotacao').val(selected.data('lotacao') || '');
        $('#funcao').val(selected.data('funcao') || '');
        $('#cpf').val(selected.data('cpf') || '');
    });
});
</script>
{% endblock %}
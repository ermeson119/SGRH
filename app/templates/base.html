<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SGRH - {% block title %}{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../static/scripts/base.css">

</head>
<body class="d-flex flex-column min-vh-100">
<nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">SGRH</a>
        <ul class="navbar-nav">
            {% if current_user.is_authenticated %}
                <li class="nav-item"><a class="nav-link" href="{{ url_for('main.pessoa_list') }}">Pessoas</a></li>
                <li class="nav-item"><a class="nav-link" href="{{ url_for('main.profissao_list') }}">Profissões</a></li>
                <li class="nav-item"><a class="nav-link" href="{{ url_for('main.folha_list') }}">Folhas</a></li>
                <li class="nav-item"><a class="nav-link" href="{{ url_for('main.capacitacao_list') }}">Capacitações</a></li>
                <li class="nav-item"><a class="nav-link" href="{{ url_for('main.relatorio_completo') }}">Relatório Completo</a></li>
                <li class="nav-item"><a class="nav-link" href="{{ url_for('main.logout') }}">Sair</a></li>
            {% else %}
                <li class="nav-item"><a class="nav-link" href="{{ url_for('main.login') }}">Login</a></li>
            {% endif %}
        </ul>
    </div>
</nav>

<div class="main-content">
    {% block content %}{% endblock %}
</div>

<footer class="bg-dark text-white text-center py-3 mt-auto">
    <div class="container">
        <small>© {{ now().year }} SGRH - Sistema de Gestão de Recursos Humanos</small>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

{% if current_user.is_authenticated %}
<script>
    // Tempo de expiração da sessão (30 minutos em milissegundos)
    const sessionTimeout = 30 * 60 * 1000;
    // Avisa 1 minuto antes da expiração
    setTimeout(() => {
        alert('Sua sessão está prestes a expirar. Faça uma ação para continuar.');
    }, sessionTimeout - 60 * 1000);

    // Opcional: Atualiza o last_activity ao interagir com a página
    document.addEventListener('click', () => {
        fetch('{{ url_for("main.pessoa_list") }}', { method: 'GET' })
            .then(() => console.log('Sessão atualizada'))
            .catch(err => console.error('Erro ao atualizar sessão:', err));
    });
</script>
{% endif %}

{% block scripts %}{% endblock %}
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'930367072937bfb5',t:'MTc0NDYzNTc5Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
</body>
</html>